from fastapi import FastAPI
from fastapi.testclient import TestClient
from starlette.status import HTTP_404_NOT_FOUND, HTTP_422_UNPROCESSABLE_ENTITY

from backend.main import app

client = TestClient(app)

from backend import __version__


def test_version():
    assert __version__ == '0.1.0'

def test_read_languages():
    response = client.get("/api/translation/getAvailableLanguages")
    assert response.status_code == 200
    assert response.json() == ['en', 'de', 'fr'] #json.dumps(ALLOWED_LANGUAGES)

def test_wrong_path():
    response = client.get("/wrong/path")
    assert response.status_code == HTTP_404_NOT_FOUND

def test_wrong_lang_in_translation():
    data = {"lang": "wrong", "text": "right"}
    response = client.post(
        "/api/translation/translate",
        json=data)
    print(response.status_code)
    assert response.status_code == HTTP_422_UNPROCESSABLE_ENTITY

def test_empty_text_in_translation():
    data = {"lang": "en", "text": ""}
    response = client.post(
        "/api/translation/translate",
        json=data)
    print(response.status_code)
    assert response.status_code == HTTP_422_UNPROCESSABLE_ENTITY

def test_long_text_in_translation():
    data = {"lang": "en", "text": "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"}
    response = client.post(
        "/api/translation/translate",
        json=data)
    print(response.status_code)
    assert response.status_code == HTTP_422_UNPROCESSABLE_ENTITY
